```{r libraries}
library(tidyverse)
```

``` {r data}
tuesdata <- tidytuesdayR::tt_load(2023, week = 9)
afrisenti <- tuesdata$afrisenti
languages <- tuesdata$languages
language_scripts <- tuesdata$language_scripts
language_countries <- tuesdata$language_countries
country_regions <- tuesdata$country_regions

colscheme <- c("#007000", "#FFBF00", "#D2222D")
```

```{r wrangling}
plotset <- afrisenti %>%
  # get regions and countries of each tweet
  left_join(language_countries, by = "language_iso_code") %>%
  left_join(country_regions, by = "country") %>%
  # mozambique already counted in southern and eastern africa
  filter(region != "Southeastern Africa") %>%
  select(label, country, region) %>%
  group_by(label, region, country) %>%
  count() %>%
  rename(count = "n") %>%
  mutate(label = factor(
    label,
    levels = c("positive", "neutral", "negative")
    )) %>%
  ungroup()
```

```{r plot}
ggplot(plotset, aes(x = region, y = count, fill = label)) +
  geom_col(position = "fill", stat = "identity") +
  scale_fill_manual(values = colscheme) +
  theme_minimal()
```

